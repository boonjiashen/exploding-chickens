<!DOCTYPE html>

<html>
  <head>
    <title>
      Exploding chickens
    </title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
  </head>
  <body>
    <canvas width="640" height="480"></canvas>
    <script>
      class Point {
        y;
        x;

        constructor(x, y) {
          this.x = x
          this.y = y
        }

        refresh(vel) {
          return new Point(this.x + vel.v_x, this.y + vel.v_y)
        }
      }

      class Velocity {
        v_x;
        v_y;

        constructor(v_x, v_y) {
          this.v_x = v_x
          this.v_y = v_y
        }
      }

      const $c = $("canvas")
      const ctx = $c[0].getContext("2d")

      function clearCanvas(context) {
        context.clearRect(0, 0, context.canvas.width, context.canvas.height)
      }

      const img = new Image()
      img.src = "images/chicken.png"
      const w = ctx.canvas.width / 5
      const h = w
      const init_loc = new Point(0, 0)
      const init_vel = new Velocity(8, 0)
      var curr_loc = init_loc
      var curr_vel = init_vel
      var isAnimationEnabled = true;

      function animate() {
        clearCanvas(ctx)
        ctx.drawImage(img, curr_loc.x, curr_loc.y, w, h)
        curr_loc = curr_loc.refresh(curr_vel)
        if (curr_loc.x > ctx.canvas.width || curr_loc.x < 0) {
          curr_vel.v_x *= -1
        }
        if (isAnimationEnabled) {
          requestAnimationFrame(animate)
        }
        else {
          clearCanvas(ctx)
        }
      }

      img.onload = animate

      $c.click(function($event) {
        const canvasRect = this.getBoundingClientRect()
        const canvasClickPoint = new Point(
          $event.clientX - canvasRect.x,
          $event.clientY - canvasRect.y,
        )
        isAnimationEnabled = false
      })
    </script>
  </body>
</html>